
Will Setup `NFS` server for demonstration,

In order to move forward, we mentioned that we need to get this `nfs` server as a separate host. Simply add another host to configure `nfs` which will be used by K 8 s to share data in between nodes in ease. 

After spinning up a VM, installing Ubuntu which can be seen here. [[00. section2-full-k8sClusterSetup#5. Kubernetes multi-node setup using kubeadm tool(cri-containerd)]]

And ssh into that VM
```sh
ssh username@NodeVMIp
```

And install **`NFS`**,
```sh
sudo apt install nfs-kernel-server
```

And verify status, 
```
sudo systemctl status nfs-kernel-server
```
And its running,. Now, we can able to access data in a shared manner.   

Now, which directory we gotta expose inorder to execute `nfs`, where the clients can use that particular folder to access the data and share it in a shared manner.

Here, the directory where the config lies is,
```
/etc/exports
```
Here in this config, have to declare by mentioning which directory to expose to the clients and for `nfs` for the others to use on this network. 

For that, will create a separate folder to expose,
```
sudo -i
```
```
mkdir /var/nfs/
```

Now we have to mention it to the config for the `nfs` to expose it to the outside for all to be shared. And we also need to change permission of the folder too, to check permission
```
ls -ld 
```
Saying that,
```
drwxr-xr-x 2 root root 4096 May 16 13:03 /var/nfs/
```
Both belongs to root. 

Have to make this folder anonymous, to make it anonymous,
```
chown -R nobody:nogroup /var/nfs
```

To verify that,
```
ls -ld
```
Saying that,
```
drwxr-xr-x 2 nobody nogroup 4096 May 16 13:03 /var/nfs/
```
Belongs to nobody and nogroup. In order to expose this directory to `nfs`, how to tell the `nfs` to expose that folder, to that `nfs` s config. Where is that config, `/etc/exports`, here EDIT THE **config**,
```
vi /etc/exports
```
And add entries that,
```
...
/var/nfs	192.168.0.0/24(rw,sync,no_subtree_check,no_root_squash)
```
-  which folder to expose **1. `/var/nfs`**
- And to which network to access/expose to - to all the client machines. 
- Enter the **2. CIDR Block**, to give access for such clients. OR
- Enter specific machines by declaring all the **machine's IP** instead of a CIDR Block.  
- And the permission to that client, **3. (rw, sync, no_subtree_check, no_root_squash)**
And apply changes.

```sh
exportfs -av
```
`exporting 192.168.0.0/24:/var/nfs`. 

Exported the folder with the client/network. Applied! Now we have successfully exposed a directory out to the client. JOB DONE WITH THE `nfs` server. 

**NOW, THE CLIENTS ON THAT CIDR BLOCK CAN ACCESS `/var/nfs`  FOLDER USING `nfs` SERVER.** 

How clients which are lying in the **CIDR** block can access and utilized the exposed `/var/nfs` directory?

WE ARE GOOD WITH THE `NFS` SERVER FOR NOW!.


---

