# **Highly Available Kubernetes Cluster Setup**

## Using HAProxy + Keepalived (2 Control Planes, 3 Worker Nodes)
A setup of a HA Kubernetes setup - using haproxy + keepalived. here's the node details.

Node Info:
**Proxies and Load Balancers:**
- lb112 - 192.168.0.112 - primary network server node with haproxy and keepalived holding 
- shared VIP - 192.168.0.111 
- lb114 - 192.168.0.114 - backup lb 
**Controlplane:**
- cp123 - 192.168.0.123 - controlplane 1 
- cp124 - 192.168.0.124 - controlplane 2 
**Workernode:**
- wn141 - 192.168.0.141 - workernode 1 
- wn143 - 192.168.0.143 - workernode 2 
- wn145 - 192.168.0.145 - workernode 3
Other nodes:
- nfs222 - 192.168.0.222 - nfs storage server

---

### **Architecture Overview**
```
                          +------------------+
                          |   VIP: 192.168.0.111   |
                          +----------+-------+
                                     |
           +-------------------------+-------------------------+
           |                                                   |
+----------v----------+                           +------------v-----------+
|      lb112 (MASTER) |                           |      lb114 (BACKUP)    |
|  HAProxy + Keepalived|                           |  HAProxy + Keepalived  |
+----------+----------+                           +------------+-----------+
           |                                                   |
           +------------------+------------------+-------------+
                              |
            +-----------------+------------------+
            |                 |                  |
+-----------v--+   +----------v--+   +-----------v--+
|   cp123      |   |   cp124     |   |  wn141/143/145 |
| Control Plane|   | Control Plane|   |   Worker Nodes |
+--------------+   +--------------+   +----------------+
```

Nodes Config:
- **Load Balancer**: HAProxy + Keepalived with shared VIP `192.168.0.111`
- **Control Planes**: `cp123` (192.168.0.123), `cp124` (192.168.0.124)
- **Workers**: `wn141` (192.168.0.141), `wn143`, `wn145`
- **Storage**: NFS server at `192.168.0.222`
- **Runtime**: containerd
- **CNI**: Calico (with Typha for scale)
- **OS**: Ubuntu 24.04 LTS

---

Start from [[1. lb1]],